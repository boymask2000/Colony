package com.colony.buildings.actors;

import com.badlogic.gdx.scenes.scene2d.Stage;
import com.colony.BaseActor;
import com.colony.Draggable;
import com.colony.buildings.BuildingsHub;
import com.colony.commons.Utils;

public class Agent extends BaseActor {
	private boolean andata = true;
	private float startX;
	private float startY;
	private float endX;
	private float endY;
	private static final int DELTA = 5;

	public Agent(float x, float y) {
		super(x, y);

	}

	public Agent(float x, float y, Stage s) {
		super(x, y, s);
	
	}
	
	boolean moving = false;

	public boolean isMoving() {
		return moving;
	}

	public void goMission(float xx, float yy) {
		startX = getX();
		startY = getY();
		endX = xx;
		endY = yy;
		moving=true;setSpeed(10);setVelocityVec(1, 1);
	}

	@Override
	public void act(float dt) {
		System.out.println("act");
		super.act(dt);

		applyPhysics(dt);
		setAnimationPaused(!isMoving());
		if (getSpeed() > 0)
			setRotation(getMotionAngle());

		float nextX = 0;
		float nextY = 0;
		if (andata) {
			float d = Utils.calcDist(getX(), getY(), endX, endY);
			float d1 = Utils.calcDist(getX() + DELTA, getY(), endX, endY);
			float d2 = Utils.calcDist(getX(), getY() + DELTA, endX, endY);
			float d3 = Utils.calcDist(getX() - DELTA, getY(), endX, endY);
			float d4 = Utils.calcDist(getX(), getY() - DELTA, endX, endY);
			if (d1 < d) {
				nextX = getX() + DELTA;
				nextY = getY();
				d = d1;
			}
			if (d2 < d) {
				nextX = getX();
				nextY = getY() + DELTA;
				d = d1;
			}
			if (d3 < d) {
				nextX = getX() - DELTA;
				nextY = getY();
				d = d1;
			}
			if (d4 < d) {
				nextX = getX();
				nextY = getY() - DELTA;
				d = d1;
			}
			if (d < DELTA)
				andata = false;
			setPosition(nextX, nextY);

		} else {
			float d = Utils.calcDist(getX(), getY(), startX, startY);
			float d1 = Utils.calcDist(getX() + DELTA, getY(), startX, startY);
			float d2 = Utils.calcDist(getX(), getY() + DELTA, startX, startY);
			float d3 = Utils.calcDist(getX() - DELTA, getY(), startX, startY);
			float d4 = Utils.calcDist(getX(), getY() - DELTA, startX, startY);
			if (d1 < d) {
				nextX = getX() + DELTA;
				nextY = getY();
				d = d1;
			}
			if (d2 < d) {
				nextX = getX();
				nextY = getY() + DELTA;
				d = d1;
			}
			if (d3 < d) {
				nextX = getX() - DELTA;
				nextY = getY();
				d = d1;
			}
			if (d4 < d) {
				nextX = getX();
				nextY = getY() - DELTA;
				d = d1;
			}
			if (d < DELTA) {
				andata = false;
				moving = false;
			}
			setPosition(nextX, nextY);

		}

		boundToWorld();

	}

	public void loadAnim() {
		String animations[] = { "pozzo.png" };
		loadAnimationFromFiles(animations, 0.1f, true);

	}

	@Override
	public void refreshEdificio() {
		// TODO Auto-generated method stub
		
	}
}
